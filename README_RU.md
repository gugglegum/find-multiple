# Find-Multiple
**Рекурсивный поиск файлов в директории, содержание которых соответствующих нескольким регулярным выражениям одновременно**

[English](README.md) | Russian

Иногда вам нужно найти определенное место в большом проекте, но вы не знаете где именно искать. Вы лишь предполагаете, что в этом файле будут упоминания определенных слов или последовательностей символов, но не знаете в каком порядке и что будет между ними. Например, вы предполагаете, что в том месте должны быть вызовы определенных функций или имена таблиц в базе данных. Однако поиск по каждому из этих слов по отдельности даёт слишком много результатов. Хотелось бы иметь функцию типа "искать в найденном", чтобы сузить область ручного поиска. Однако, ваша любимая IDE от JetBrains (PHPStorm) не умеет так делать. На помощь приходит данная утилита. Вы передаёте ей в качестве параметров командной строки директорию поиска, маску файлов (например, "*.php") и дальше одно или несколько регулярных выражений вида, каждому из которых должна соответствовать хотя бы одна строка искомом файле. Скрипт рекурсивно сканирует указанную директорию, ищет файлы заданной маски, проверяет их на соответствие всем регулярным выражениям и выводит найденные файлы. Помимо имён файлов скрипт также выводит фрагменты этих файлов с номерами строк, где были найдены строки, соответствующие каждому из регулярных выражений. Показываются 5 строк до и 5 строк после строки, которая соответствует регулярному выражению. Строка, которая соответствует регулярному выражению выделяется символом ">". Несколько близких фрагментов объединяются в один болшой фрагмент. Смотрите скриншот, чтобы лучше понять как это работает на примере.

## Screenshot
![2024-06-30_02-18-34](https://github.com/gugglegum/find-multiple/assets/1580712/020740cb-5cb9-4541-896f-08635cd86e3b)

На приведенном скриншоте мы ищем в текущей директории файлы `*.php`, в которых есть строки, соответствующие 2 регулярным выражениям: `/'_'|"_"/` и `/time\(\)/`.

## Использование

```shell
php find-multiple.php /path/to/dir "*.php" "/regex1/" "/regex2/" ... "/regexN/"
```

Рекомендуется заключать регулярное выражение в кавычки, чтобы не было проблем с интерпретацией кавычек, звездочек (`*`), вертикальной черты (`|`), `<`, `>`, `&` и т.д. При этом кавычки внутри регулярного выражения нужно дополнительно экранировать обратным слэшем `\`. Для проверки корректности передачи параметров декодированные параметры выводятся в начале работы скрипта.

**Внимание Linux пользователей:** Передавая файловую маску (2-ой параметр) не забудьте заключить её тоже в кавычки, потому что иначе bash скрытно заменит этот параметр на файлы, которые соответствуют этой маске в текущей директории. В результате нарушится порядок параметров и часть имен файлов будут интерпретированы скриптом как некорректные регулярные выражения.
